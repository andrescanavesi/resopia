doctype html
html(lang="es")
  head
    link(rel="preconnect" href="//stackpath.bootstrapcdn.com"  crossorigin)
    if isProduction
      //Global site tag (gtag.js) - Google Analytics
      link(rel="preconnect" href="//googletagmanager.com"  crossorigin)
      script(async='', src='https://www.googletagmanager.com/gtag/js?id=UA-155091761-1')
      script.
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-155091761-1');
    
    title= title
   
    meta(http-equiv='Content-Type', content='text/html; charset=UTF-8')
    meta(charset='utf-8')
    meta(http-equiv='Cache-control', content=metaCache)
    meta(name='theme-color', content='#009900')
    meta(name='msapplication-square310x310logo', content=pageLogo)
    meta(name='viewport', content='width=device-width, initial-scale=1')
    meta(name='author', content='Resopia')
    meta(name='language', content='es')
    meta(name='keywords', content=keywords)
    meta(name='robots', content='Index, Follow')
    meta(property='og:locale', content='es_ES')
    meta(property='og:type', content='article')
    meta(property='og:site_name', content='Resopia')
    meta(property='article:publisher', content='http://www.resopia.com/')
    meta(property='article:author', content='http://www.resopia.com/')
    meta(name='title', content=title)
    meta(name='description', content=description)
    meta(property='og:title', content=title)
    meta(property='og:description', content=description)
    meta(property='og:url', content=linkToThisPage)
    meta(property='og:image', content=metaImage)
    meta(property='article:modified_time', content=updatedAt)
    if isHomePage
      script(async='async', defer='true', charset='UTF-8', type='application/ld+json').
        {
          "@context": "http://schema.org/",
          "@type": "WebSite",
          "url": "http://resopia.com/",
          "potentialAction": {
            "@type": "SearchAction",
            "target": "http://resopia.com/buscar?q={search_term_string}",
            "query-input": "required name=search_term_string"
          },
          "image": [
            "#{pageImage}"
          ],
          "datePublished": "#{pageDatePublished}",
          "dateModified": "#{pageDateModified}",
          "author": {
            "@type": "Organization",
            "name": "Resopia"
          },
          "publisher": {
            "@type": "Organization",
            "name": "Resopia",
            "logo": {
              "@type": "ImageObject",
                "url": "#{pageLogo}"
            }
          },
          "description": "#{pageDescription}"
        }
    if isRecipePage
      script(async='async', defer='true', charset='UTF-8', type='application/ld+json').
        {
            "@context": "http://schema.org/",
            "@type": "#{pageType}",
            "name": "#{pageName}",
            "image": [
              "#{pageImage}"
            ],
            "datePublished": "#{pageDatePublished}",
            "dateModified": "#{pageDateModified}",
            "description": "#{pageDescription}",
            "keywords": "#{pageKeywords}",
            "recipeIngredient": !{pageRecipeIngredients},
            "recipeInstructions": !{pageRecipeInstructions},
            "recipeCategory": "#{pageRecipeCategory}",
            "author": {
              "@type": "Organization",
              "name": "resopia.com"
            },
            "prepTime":"#{pageRecipePrepTime}",
            "cookTime":"#{pageRecipeCookTime}",
            "totalTime":"#{pageRecipeTotalTime}",
            "recipeCuisine":"#{pageRecipeCusine}",
            "recipeYield":"#{pageRecipeYield}",
            "video":"#{pageRecipeVideo}"
        }         
    
    link(href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css", rel="stylesheet", integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T", crossorigin="anonymous")
    link(rel='stylesheet', type='text/css', href='/stylesheets/style.css')
    link(rel="icon", sizes="192x192", href=pageLogo)
    link(rel="apple-touch-icon" href=pageLogo)

  body
    .shadow-sm.pb-3.mb-3.sticky-top.bg-white-095
      header
        .d-flex.justify-content-between.mt-3.px-2.pt-3
          .dropdown
            button#dropdownMenuButton.btn.btn-outline-dark.dropdown-toggle(type='button', onclick="trackEvent(this,'default')", data-toggle='dropdown', aria-haspopup='true', aria-expanded='false')
              | Menu
            #dropdownMenuList.dropdown-menu(aria-labelledby='dropdownMenuButton')
              a#menuItemInicio.dropdown-item(href='/', title="Ir al inicio") Inicio
              a#menuItemVideos.dropdown-item(href='https://www.facebook.com/Resopiacom-110467097132918', title="Facebook") Facebook
              a#menuItemVideos.dropdown-item(href='/recetas/video', title="Recetas con video") Videos
              a#menuItemCeliacos.dropdown-item(href='/recetas/celiacos', title="Recetas aptas para celíacos") Celíacos   
          h1
            a(href="/").text-dark
              span.brand Resopia
          div(style="width: 3rem") &nbsp; 
      
    .container-fluid
        .row
          .col-md-3
          .col-md-6
            .py-1.px-1
              input#searchTop(name='search', type='text', title="Buscar receta",
                  onclick="trackEvent(this,'search')"
                  placeholder='Buscar una receta', onkeyup="searchTop(event)", 
                  value=searchText).form-control.form-control
          .col-md-3
        .row
          .col-md-3
            //left
          .col-md-6
            .mt-3
            block content
            .text-center.mt-3
              a(href='https://www.facebook.com/Resopiacom-110467097132918')
                img.lozad.img-fluid(data-src="https://res.cloudinary.com/dniiru5xy/image/upload/c_scale,w_500,q_auto:low/v1577283800/resopia.com/facebook-fanpage.png")
            //related recipes
            if displayMoreRecipes
              .mt-4.border-top
                h2.mx-1.pt-3 Más recetas
                .row
                  each recipe in recipesSpotlight
                    .col-sm-6.text-center
                      - var img = recipe.thumbnail500
                      div.bg-secondary.py-1
                        a(href=`${recipe.url}`, title="Ver receta").text-white.py-1.font-weight-bold=recipe.title
                      a(href=`${recipe.url}`, title="Ver receta")
                        img.lozad(data-src=img, alt='imagen receta').img-fluid.mb-2
                       
          .col-md-3
            //right column
    .row
      .col   
        .search-section.bg-primary.px-2
          input#searchBottom(name='searchBottom' type='text', title="Buscar receta"
                  onclick="trackEvent(this,'search')"
                  placeholder='Buscar receta', onkeyup="searchBottom(event)", 
                  value=searchText).form-control.form-control 
    //footer
    footer.bg-dark.py-5.background-carbon-fibre
      .container.py-2
        .row.justify-content-center
          div
            span.text-white © 2020 Copyright 
            a(href='/', title="Go to home page")  
              span.text-white www.resopia.com
           
  //jquery and popper cannot be loaded async since is a dependency of bootstra.min.js
  script(src='https://code.jquery.com/jquery-3.4.1.slim.min.js' integrity='sha256-pasqAKBDmFT4eHoN2ndd6lN370kFiGUFyTiUHWhU7k8' crossorigin='anonymous')
  script(src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js' integrity='sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1' crossorigin='anonymous')
  //lozad to load images in a lazy way. Must be loaded sync
  script(src='https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js'  crossorigin='anonymous')
  
  script(async='', src='https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js' integrity='sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM' crossorigin='anonymous')
  script(async='', src='/javascripts/track.js')
  script(async='', src='/javascripts/common.js')
  script(type='text/javascript').
    $(document).ready(() => {
      // to load images in a lazy way
      // lazy loads elements with default selector as '.lozad'
      const observer = lozad(); 
      observer.observe();
      console.info('lozad observing...');
    });
